/*--------------------------------------------------------------------------
**
**  Copyright (c) 2003-2004, Tom Hunter (see license.txt)
**
**  Name: console.c
**
**  Description:
**      CDC 6600 character set conversions.
**
**--------------------------------------------------------------------------
*/

/*
**  -------------
**  Include Files
**  -------------
*/
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "const.h"
#include "types.h"
#include "proto.h"

/*
**  --------------------------------------
**  Public character set conversion tables
**  --------------------------------------
*/
const u8 asciiToCdc[256] =
    {
    /* 000- */  0,      0,      0,      0,      0,      0,      0,      0,
    /* 010- */  0,      0,      0,      0,      0,      0,      0,      0,
    /* 020- */  0,      0,      0,      0,      0,      0,      0,      0,
    /* 030- */  0,      0,      0,      0,      0,      0,      0,      0,
    /* 040- */  055,    066,    064,    060,    053,    063,    067,    070,
    /* 050- */  051,    052,    047,    045,    056,    046,    057,    050,
    /* 060- */  033,    034,    035,    036,    037,    040,    041,    042,
    /* 070- */  043,    044,    0,      077,    072,    054,    073,    071,
    /* 100- */  074,    001,    002,    003,    004,    005,    006,    007,
    /* 110- */  010,    011,    012,    013,    014,    015,    016,    017,
    /* 120- */  020,    021,    022,    023,    024,    025,    026,    027,
    /* 130- */  030,    031,    032,    061,    075,    062,    076,    065,
    /* 140- */  0,      001,    002,    003,    004,    005,    006,    007,
    /* 150- */  010,    011,    012,    013,    014,    015,    016,    017,
    /* 160- */  020,    021,    022,    023,    024,    025,    026,    027,
    /* 170- */  030,    031,    032,    061,    0,      0,      0,      0
    };

const char cdcToAscii[64] =
    {
    /* 00-07 */ ':',    'A',    'B',    'C',    'D',    'E',    'F',    'G',
    /* 10-17 */ 'H',    'I',    'J',    'K',    'L',    'M',    'N',    'O',
    /* 20-27 */ 'P',    'Q',    'R',    'S',    'T',    'U',    'V',    'W',
    /* 30-37 */ 'X',    'Y',    'Z',    '0',    '1',    '2',    '3',    '4',
    /* 40-47 */ '5',    '6',    '7',    '8',    '9',    '+',    '-',    '*',
    /* 50-57 */ '/',    '(',    ')',    '$',    '=',    ' ',    ',',    '.',
    /* 60-67 */ '#',    '[',    ']',    '%',    '"',	'_',	'!',	'&',
    /* 70-77 */ '\'',   '?',    '<',    '>',    '@',    '\\',   '^',    ';'
    };

const u8 asciiToConsole[256] =
    {
    /* 00-07 */ 0,      0,      0,      0,      0,      0,      0,      0,
    /* 08-0F */ 061,    0,      060,    0,      0,      060,    0,      0,
    /* 10-17 */ 0,      0,      0,      0,      0,      0,      0,      0,
    /* 18-1F */ 0,      0,      0,      0,      0,      0,      0,      0,
    /* 20-27 */ 062,    0,      0,      0,      0,      0,      0,      0,
    /* 28-2F */ 051,    052,    047,    045,    056,    046,    057,    050,
    /* 30-37 */ 033,    034,    035,    036,    037,    040,    041,    042,
    /* 38-3F */ 043,    044,    0,      0,      0,      054,    0,      0,
    /* 40-47 */ 0,      01,     02,     03,     04,     05,     06,     07,
    /* 48-4F */ 010,    011,    012,    013,    014,    015,    016,    017,
    /* 50-57 */ 020,    021,    022,    023,    024,    025,    026,    027,
    /* 58-5F */ 030,    031,    032,    053,    0,      055,    0,      0,
    /* 60-67 */ 0,      01,     02,     03,     04,     05,     06,     07,
    /* 68-6F */ 010,    011,    012,    013,    014,    015,    016,    017,
    /* 70-77 */ 020,    021,    022,    023,    024,    025,    026,    027,
    /* 78-7F */ 030,    031,    032,    0,      0,      0,      0,      0
    };

const char consoleToAscii[64] =
    {
    /* 00-07 */ 0,      'A',    'B',    'C',    'D',    'E',    'F',    'G',
    /* 10-17 */ 'H',    'I',    'J',    'K',    'L',    'M',    'N',    'O',
    /* 20-27 */ 'P',    'Q',    'R',    'S',    'T',    'U',    'V',    'W',
    /* 30-37 */ 'X',    'Y',    'Z',    '0',    '1',    '2',    '3',    '4',
    /* 40-47 */ '5',    '6',    '7',    '8',    '9',    '+',    '-',    '*',
    /* 50-57 */ '/',    '(',    ')',    ' ',    '=',    ' ',    ',',    '.',
    /* 60-67 */  0,      0,      0,      0,      0,      0,      0,      0,
    /* 70-77 */  0,      0,      0,      0,      0,      0,      0,      0
    };

const u16 asciiTo026[256] =
    {
    /*                                                                         */
    /* 000- */  0,      0,      0,      0,      0,      0,      0,      0,
    /*                                                                         */
    /* 010- */  0,      0,      0,      0,      0,      0,      0,      0,
    /*                                                                         */
    /* 020- */  0,      0,      0,      0,      0,      0,      0,      0,
    /*                                                                         */
    /* 030- */  0,      0,      0,      0,      0,      0,      0,      0,
    /*          space   !       "       #       $       %       &       '      */
    /* 040- */  0,      03000,  00042,  01012,  02102,  00012,  01006,  02022,
    /*          (       )       *       +       ,       -       .       /      */
    /* 050- */  01042,  04042,  02042,  04000,  01102,  02000,  04102,  01400,
    /*          0       1       2       3       4       5       6       7      */
    /* 060- */  01000,  00400,  00200,  00100,  00040,  00020,  00010,  00004,
    /*          8       9       :       ;       <       =       >       ?      */
    /* 070- */  00002,  00001,  00202,  04006,  05000,  00102,  02006,  02012,
    /*          @       A       B       C       D       E       F       G      */
    /* 100- */  00022,  04400,  04200,  04100,  04040,  04020,  04010,  04004,
    /*          H       I       J       K       L       M       N       O      */
    /* 110- */  04002,  04001,  02400,  02200,  02100,  02040,  02020,  02010,
    /*          P       Q       R       S       T       U       V       W      */
    /* 120- */  02004,  02002,  02001,  01200,  01100,  01040,  01020,  01010,
    /*          X       Y       Z       [       \       ]       ^       _      */
    /* 130- */  01004,  01002,  01001,  00006,  04022,  01202,  04012,  01022,
    /*          `       a       b       c       d       e       f       g      */
    /* 140- */  0,      04400,  04200,  04100,  04040,  04020,  04010,  04004,
    /*          h       i       j       k       l       m       n       o      */
    /* 150- */  04002,  04001,  02400,  02200,  02100,  02040,  02020,  02010,
    /*          p       q       r       s       t       u       v       w      */
    /* 160- */  02004,  02002,  02001,  01200,  01100,  01040,  01020,  01010,
    /*          x       y       z       {       |       }       ~              */
    /* 170- */  01004,  01002 , 01001,  00015,  0,      00017,  00007,  0
    };


const u16 asciiTo029[256] =
    {
    /*                                                                         */
    /* 000- */  0,      0,      0,      0,      0,      0,      0,      0,
    /*                                                                         */
    /* 010- */  0,      0,      0,      0,      0,      0,      0,      0,
    /*                                                                         */
    /* 020- */  0,      0,      0,      0,      0,      0,      0,      0,
    /*                                                                         */
    /* 030- */  0,      0,      0,      0,      0,      0,      0,      0,
    /*          space   !       "       #       $       %       &       '      */
    /* 040- */  0,      04006,  00006,  00102,  02102,  01042,  04000,  00022,
    /*          (       )       *       +       ,       -       .       /      */
    /* 050- */  04022,  02022,  02042,  04012,  01102,  02000,  04102,  01400,
    /*          0       1       2       3       4       5       6       7      */
    /* 060- */  01000,  00400,  00200,  00100,  00040,  00020,  00010,  00004,
    /*          8       9       :       ;       <       =       >       ?      */
    /* 070- */  00002,  00001,  00202,  02012,  04042,  00012,  01012,  01006,
    /*          @       A       B       C       D       E       F       G      */
    /* 100- */  00042,  04400,  04200,  04100,  04040,  04020,  04010,  04004,
    /*          H       I       J       K       L       M       N       O      */
    /* 110- */  04002,  04001,  02400,  02200,  02100,  02040,  02020,  02010,
    /*          P       Q       R       S       T       U       V       W      */
    /* 120- */  02004,  02002,  02001,  01200,  01100,  01040,  01020,  01010,
    /*          X       Y       Z       [       \       ]       ^       _      */
    /* 130- */  01004,  01002,  01001,  04202,  01202,  02202,  02006,  01022,
    /*          `       a       b       c       d       e       f       g      */
    /* 140- */  0,      04400,  04200,  04100,  04040,  04020,  04010,  04004,
    /*          h       i       j       k       l       m       n       o      */
    /* 150- */  04002,  04001,  02400,  02200,  02100,  02040,  02020,  02010,
    /*          p       q       r       s       t       u       v       w      */
    /* 160- */  02004,  02002,  02001,  01200,  01100,  01040,  01020,  01010,
    /*          x       y       z       {       |       }       ~              */
    /* 170- */  01004,  01002 , 01001,  00015,  0,      00017,  00007,  0
    };

/*
**  077 is & but is also used as filler for unused codes
*/
const u8 asciiToBcd[256] =
    {
    /*                                                                         */
    /* 000- */  077,    077,    077,    077,    077,    077,    077,    077,
    /*                                                                         */
    /* 010- */  077,    077,    077,    077,    077,    077,    077,    077,
    /*                                                                         */
    /* 020- */  077,    077,    077,    077,    077,    077,    077,    077,
    /*                                                                         */
    /* 030- */  077,    077,    077,    077,    077,    077,    077,    077,
    /*          space   !       "       #       $       %       &       '      */
    /* 040- */  060,    052,    014,    076,    053,    016,    077,    055,
    /*          (       )       *       +       ,       -       .       /      */
    /* 050- */  074,    034,    054,    020,    073,    040,    033,    061,
    /*          0       1       2       3       4       5       6       7      */
    /* 060- */  000,    001,    002,    003,    004,    005,    006,    007,
    /*          8       9       :       ;       <       =       >       ?      */
    /* 070- */  010,    011,    012,    037,    032,    013,    057,    056,
    /*          @       A       B       C       D       E       F       G      */
    /* 100- */  015,    021,    022,    023,    024,    025,    026,    027,
    /*          H       I       J       K       L       M       N       O      */
    /* 110- */  030,    031,    041,    042,    043,    044,    045,    046,
    /*          P       Q       R       S       T       U       V       W      */
    /* 120- */  047,    050,    051,    062,    063,    064,    065,    066,
    /*          X       Y       Z       [       \       ]       ^       _      */
    /* 130- */  067,    070,    071,    017,    035,    072,    036,    075,
    /*          `       a       b       c       d       e       f       g      */
    /* 140- */  077,    021,    022,    023,    024,    025,    026,    027,
    /*          h       i       j       k       l       m       n       o      */
    /* 150- */  030,    031,    041,    042,    043,    044,    045,    046,
    /*          p       q       r       s       t       u       v       w      */
    /* 160- */  047,    050,    051,    062,    063,    064,    065,    066,
    /*          x       y       z       {       |       }       ~              */
    /* 170- */  067,    070,    071,    077,    077,    077,    077,    077
    };

const char bcdToAscii[64] =
    {
    /* 00-07 */     '0',    '1',    '2',    '3',    '4',    '5',    '6',    '7',
    /* 10-17 */     '8',    '9',    ':',    '=',    '"',    '@',    '%',    '[',
    /* 20-27 */     '+',    'A',    'B',    'C',    'D',    'E',    'F',    'G',
    /* 30-37 */     'H',    'I',    '<',    '.',    ')',    '\\',    '^',    ';',
    /* 40-47 */     '-',    'J',    'K',    'L',    'M',    'N',    'O',    'P',
    /* 50-57 */     'Q',    'R',    '!',    '$',    '*',    0x27,    '?',    '>',
    /* 60-67 */     ' ',    '/',    'S',    'T',    'U',    'V',    'W',    'X',
    /* 70-77 */     'Y',    'Z',    ']',    ',',    '(',    '_',    '#',    '&'
    };

const char extBcdToAscii[64] = {
    /* 00-07 */     ':',    '1',    '2',    '3',    '4',    '5',    '6',    '7',
    /* 10-17 */     '8',    '9',    '0',    '=',    '"',    '@',    '%',    '[',
    /* 20-27 */     ' ',    '/',    'S',    'T',    'U',    'V',    'W',    'X',
    /* 30-37 */     'Y',    'Z',    ']',    ',',    '(',    '_',    '#',    '&',
    /* 40-47 */     '-',    'J',    'K',    'L',    'M',    'N',    'O',    'P',
    /* 50-57 */     'Q',    'R',    '!',    '$',    '*',   '\'',    '?',    '>',
    /* 60-67 */     '+',    'A',    'B',    'C',    'D',    'E',    'F',    'G',
    /* 70-77 */     'H',    'I',    '<',    '.',    ')',   '\\',    '^',    ';'
    };

/*  Plato keycodes translation */

/* This translates ASCII codes to PLATO text string codes.  0 means end of line,
 * which is encoded as 0000 at end of word. 76 and/or 70 are prefix codes (access
 * and shift respectively).
 */
const int asciiToPlatoString[256] =
{
 /*                                                                         */
 /* 000- */ -1,     -1,     -1,     -1,     -1,     -1,     -1,     -1,
 /*                                                                         */
 /* 010- */  0,     -1,     -1,     -1,     -1,     -1,     -1,     -1,
 /*                                                                         */
 /* 020- */ -1,     -1,     -1,     -1,     -1,     -1,     -1,     -1,
 /*                                                                         */
 /* 030- */ -1,     -1,     -1,     -1,     -1,     -1,     -1,     -1,
 /*          space   !       "       #       $       %       &       '      */
 /* 040- */055,     07057,  07056, 07653,    053,    063, 07645,  07042,
 /*          (       )       *       +       ,       -       .       /      */
 /* 050- */   051,    052,    047,    045,    056,    046,    057,    050,
 /*          0       1       2       3       4       5       6       7      */
 /* 060- */   033,    034,    035,    036,   037,    040,    041,    042,
 /*          8       9       :       ;       <       =       >       ?      */
 /* 070- */   043,    044,  07077,    077,    072,    054,    073,  07050,
 /*          @       A       B       C       D       E       F       G      */
 /* 100- */ 07640,  07001,  07002,  07003,  07004,  07005,  07006,  07007,
 /*          H       I       J       K       L       M       N       O      */
 /* 110- */ 07010,  07011,  07012,  07013,  07014,  07015,  07016,  07017,
 /*          P       Q       R       S       T       U       V       W      */
 /* 120- */ 07020,  07021,  07022,  07023,  07024,  07025,  07026,  07027,
 /*          X       Y       Z       [       \       ]       ^       _      */
 /* 130- */ 07030,  07031,  07032,    061,  07650,    062,  07630,  07041,
 /*          `       a       b       c       d       e       f       g      */
 /* 140- */ 07621,    001,    002,    003,    004,    005,    006,    007,
 /*          h       i       j       k       l       m       n       o      */
 /* 150- */   010,    011,    012,    013,    014,    015,    016,    017,
 /*          p       q       r       s       t       u       v       w      */
 /* 160- */   020,    021,    022,    023,    024,    025,    026,    027,
 /*          x       y       z       {       |       }       ~              */
 /* 170- */   030,    031,    032,  07661,0767011,  07662,  07677,  -1,
 /*                                                                         */
 /* 200- */ -1,     -1,     -1,     -1,     -1,     -1,     -1,     -1,
 /*                                                                         */
 /* 210- */ -1,     -1,     -1,     -1,     -1,     -1,     -1,     -1,
 /*                                                                         */
 /* 220- */ -1,     -1,     -1,     -1,     -1,     -1,     -1,     -1,
 /*                                                                         */
 /* 230- */ -1,     -1,     -1,     -1,     -1,     -1,     -1,     -1,
 /*                  ¡       ¢       £       ¤       ¥       ¦       §      */
 /* 240- */ -1,     -1,     -1,     -1,     -1,     -1,0767011,     -1,
 /*          ¨       ©       ª       «       ¬       ­       ®       ¯      */
 /* 250- */ -1,0767003,     -1,     -1,     -1,     -1,     -1,     -1,
 /*          °       ±       ²       ³       ´       µ       ¶       ·      */
 /* 260- */ -1,     -1,     -1,     -1,     -1,0767015,     -1,     -1,
 /*          ¸       ¹       º       »       ¼       ½       ¾       ¿      */
 /* 270- */ -1,     -1,     -1,     -1,     -1,     -1,     -1,     -1,
 /*          À         Á         Â         Ã         Ä         Å         Æ         Ç      */
 /* 300- */070017621,070017605,070017630,070017616,070017625,  -1,       -1,     070037603,
 /*          È         É         Ê         Ë         Ì         Í         Î         Ï      */
 /* 310- */070057621,070057605,070057630,070057625,070117621,070117605,070117630,070117625,
 /*          Ð         Ñ         Ò         Ó         Ô         Õ         Ö         ×      */
 /* 320- */ -1,      070167616,070177621,070177605,070177630,  -1,      070177625, -1,
 /*          Ø         Ù         Ú         Û         Ü         Ý         Þ         ß      */
 /* 330- */ -1,      070257621,070257605,070257630,070257625,070317605,  -1,     07402,
 /*          à         á         â         ã         ä         å         æ         ç      */
 /* 340- */0017621,  0017605,  0017630,  0017616,  0017625,    -1,       -1,     0037603,
 /*          è         é         ê         ë         ì         í         î         ï      */
 /* 350- */0057621,  0057604,  0057630,  0057625,  0117621,  0117605,  0117630,  0117625,
 /*          ð         ñ         ò         ó         ô         õ         ö         ÷      */
 /* 360- */ -1,      0167616,  0177621,  0177605,  0177630,    -1,     0177625,    -1,
 /*          ø         ù         ú         û         ü         ý         þ         ÿ      */
 /* 370- */ -1,      0257621,  0257605,  0257630,  0257625,  0317605,    -1,     0317625,
};

/* This translates PLATO string codes (as opposed to key codes) into ASCII, or
 * more precisely, ISO 8859-1 ("Latin-1").
 * \001 marks codes that don't translate to Latin-1 or are unused altogether,  
 * and will be ignored during translation.
 * The four lines correspond to unshifted characters, shifted (preceded by 070), 
 * access (preceded by 076) and shifted access characters.
 */
const unsigned char platoStringToAscii[4][65] = {
    "\001abcdefghijklmnopqrstuvwxyz0123456789+-*/()$= ,.\xf7[]%\xd7\xab\001\001\001\001<>\001\001\001;",
    "\001ABCDEFGHIJKLMNOPQRSTUVWXYZ\001\001\001\001\001\001_'\001\001\001\001\001\001{}&\001\001\"!\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001:",
    "\001\001\001\001\001\001\001\xe6\xf8\001\xe5\xe4\001\xb5\001\xb0\001\001\001\001\001\001\001\001\001\xf6\001\xab\xbb\001\001\001@\xbb\001\001\001&\001\001\\\001\001#\001\001\001\001\001{}\001\xba\001\001\001\001\001\001\001\001\001\001~",
    "\001\001\001\xa9\001\001\xc6\xd8|\xc5\xc4\001\001\001\001\001\001\001\001\001\001\001\001\001\xd6\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001"};

/*---------------------------  End Of File  ------------------------------*/

